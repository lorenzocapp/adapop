# adapop_numexp
This repository contains codes to reproduce our numerical experiments and data files for SARS-CoV-2 application using our implemented R package [`adapref`](https://github.com/lorenzocapp/adapref). The details of our method can be found in [our paper](). 

### Required package
* [`adapref`](https://github.com/lorenzocapp/adapref)
* [`phylodyn`](https://github.com/JuliaPalacios/phylodyn)
* [`ape`](https://cran.r-project.org/web/packages/ape/index.html)


### Simulation pipeline
1. `data_generation.R`
Generate all simulated dataset and save the synthetic data to *data* folder. 
Requires `scenarios.R` that contains all dependent populations' scenarios considered in the numerical experiments.  

2. `master_inla_simulations.R`
Load simulated data generated by `data_generation.R` (5 scenarios, 100 seeds) and perform inference and evaluation of the inference. The script is meant to be run on a HPC cluster. 
Requires `functions_inla_selection.R` that contains the beta version of *adapref*.


### Real data application
`real_data` folder contains relevant files used for reproducing the real data analyses of delta and non-delta SARS-CoV-2 sequences from South Korea and Italy. The published results were generated using our R package *adapref*.

* `GISAID_IDs`
Each file contains 150 sequences. The GISAID EPI_SET IDs and DOI for web viewing can be found in Table S2 of the Supporting Information of the manuscript.   

* `XML`
This folder contains BEAST2 xml files. The data block has been removed. The necessary genetic data can be downloaded from GISAID using the IDs in the [GISAID_IDs](real_data/GISAID_IDs) folder. 
